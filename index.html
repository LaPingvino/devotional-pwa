<!doctype html>
<html lang="en">
    <head>
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/icon?family=Material+Icons"
        />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/icon?family=Noto+Sans+Symbols+2"
        />
        <link
            rel="stylesheet"
            href="https://code.getmdl.io/1.3.0/material.blue_grey-blue.min.css"
        />
        <link rel="stylesheet" href="styles.css" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="manifest" href="devotional.webmanifest" />
        <link rel="icon" href="windows11/Square44x44Logo.targetsize-48.png" />
        <script
            defer
            src="https://code.getmdl.io/1.3.0/material.min.js"
        ></script>
        <title>&#x1f7d9; Holywritings.net</title>
    </head>
    <body>


        <div class="mdl-layout mdl-js-layout">
            <header class="mdl-layout__header">
                <div class="mdl-layout__header-row">
                    <a
                        href="#"
                        onclick="window.location.hash='#'; return false;"
                        class="mdl-layout-title"
                        style="color: white; text-decoration: none"
                    >
                        <span class="star">&#x1f7d9;</span> Holy Writings Reader
                    </a>
                    <div class="mdl-layout-spacer"></div>
                    <div
                        class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right"
                        style="margin-right: 2px"
                    >
                        <label
                            class="mdl-button mdl-js-button mdl-button--icon"
                            for="header-search-field"
                        >
                            <i class="material-icons">search</i>
                        </label>
                        <div class="mdl-textfield__expandable-holder">
                            <input
                                class="mdl-textfield__input"
                                type="text"
                                id="header-search-field"
                                placeholder="Search Prayers"
                            />
                            <label
                                class="mdl-textfield__label"
                                for="header-search-field"
                            ></label>
                        </div>
                    </div>
                    <nav class="mdl-navigation" id="prayer-language-nav">
                        <a class="mdl-navigation__link" href="">Loading...</a>
                    </nav>
                </div>
            </header>
            <div class="mdl-layout__drawer">
                <a
                    href="#"
                    onclick="window.location.hash='#'; document.querySelector('.mdl-layout').MaterialLayout.toggleDrawer(); return false;"
                    class="mdl-layout-title"
                    style="
                        color: rgba(0, 0, 0, 0.87);
                        text-decoration: none;
                        display: block;
                        padding: 16px;
                        margin-bottom: 8px;
                        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
                        font-size: 1.2em;
                        font-weight: 500;
                    "
                >
                    <span
                        class="star"
                        style="font-size: 1.2em; vertical-align: middle"
                        >&#x1f7d9;</span
                    >
                    Holy Writings
                </a>
                <div style="padding: 0 16px 8px 16px">
                    <div
                        class="mdl-textfield mdl-js-textfield"
                        style="width: 100%; padding: 0"
                    >
                        <input
                            class="mdl-textfield__input"
                            type="text"
                            id="drawer-search-field"
                            placeholder="Search Prayers"
                        />
                        <!-- <label class="mdl-textfield__label" for="drawer-search-field">Search...</label> -->
                    </div>
                </div>
                <nav class="mdl-navigation" id="drawer-prayer-language-nav">
                    <span
                        class="mdl-navigation__link"
                        style="font-style: italic; color: #757575"
                        >Languages N/A</span
                    >
                </nav>
                <nav class="mdl-navigation main-drawer-nav">
                    <a class="mdl-navigation__link" href="#prayers">Prayers</a>
                    <!-- for now, we don't have any songs etc.
                    <a class="mdl-navigation__link" href="#songs">Songs</a>
                    <a class="mdl-navigation__link" href="#books">Books</a>
                    <a class="mdl-navigation__link" href="#programs"
                        >Programs</a
                    >
                    -->
                </nav>
                <img
                    src="windows10/StoreLogo.scale-400.png"
                    style="
                        margin: 50px auto;
                        width: 100px;
                        height: 100px;
                        display: block;
                        clear: both;
                    "
                />
                <div>
                    Work in progress - source code is available on
                    <a href="https://github.com/LaPingvino/devotional-pwa"
                        >GitHub</a
                    >. By
                    <a href="https://github.com/LaPingvino">Joop Kiefte</a>
                </div>
            </div>
            <main class="mdl-layout__content">
                <div id="main-view-container">
                    <div id="content-column">
                        <div id="content">
                            <!-- Content will be dynamically loaded here -->
                            <p>Loading content...</p>
                        </div>
                    </div>
                    <div id="prayer-matching-tool">
                        <h4>Prayer Matching Helper</h4>
                        <div id="pinned-prayer-section">
                            <!-- Pinned prayer info and Unpin button will go here -->
                            <p>No prayer is currently pinned.</p>
                            <!-- Pinned prayer text will be appended here by JS -->
                        </div>
                        <div
                            id="collected-items-section" /* Renamed from collected-matches-section */
                            style="margin-top: 15px"
                        >
                            <h5>Collected Items:</h5>
                            <ul
                                id="collected-items-list" /* Renamed from collected-matches-list */
                                style="
                                    list-style-type: none;
                                    padding-left: 0;
                                    margin-top: 5px;
                                "
                            >
                                <li>No items collected yet.</li> <!-- Changed from "matches" -->
                            </ul>
                        </div>
                        <div
                            style="
                                display: flex;
                                flex-direction: column;
                                gap: 10px; /* Adjusted gap for vertical layout */
                                margin-top: 15px;
                            "
                        >
                            <button
                                id="review-and-send-button" /* Was dolthub-issue-button */
                                class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent" /* Changed style */
                                disabled
                                style="width: 100%;" /* Make button full width */
                            >
                                <i class="material-icons" style="margin-right: 4px;">send</i> Review & Send Items
                            </button>
                            <div style="text-align: center;">
                                <a href="#" id="clear-all-items-link"
                                   style="
                                       font-size: 0.9em;
                                       color: #757575;
                                       text-decoration: none;
                                       display: none; /* Initially hidden, shown by JS */
                                       padding: 8px 0;
                                       line-height: 1.5;
                                   ">
                                    <i class="material-icons" style="font-size: 1.1em; vertical-align: text-bottom; margin-right: 2px;">delete_sweep</i>
                                    Clear All Items & Unpin
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="contribution-section">
                    <h3>How to Contribute</h3>
                    <p>
                        You can help improve this collection of holy writings by
                        contributing in the following ways:
                    </p>
                    <ul>
                        <li>
                            <strong>Find other language versions:</strong> If
                            you find a prayer in a different language that
                            matches one on this site, please send the Phelps
                            code (if available) or the link of the page from
                            this site, along with the link of the matching
                            prayer, to
                            <a href="mailto:ikojba@gmail.com"
                                >ikojba@gmail.com</a
                            >. You can also use the "Prayer Matching Helper"
                            tool above to collect items and submit them.
                        </li>
                        <li>
                            <strong>Contribute directly on DoltHub:</strong> You
                            can contribute directly to the database on
                            <a
                                href="https://www.dolthub.com/repositories/holywritings/bahaiwritings"
                                target="_blank"
                                >dolthub.com/holywritings/bahaiwritings</a
                            >. This is a version-controlled SQL database where
                            you can propose changes.
                        </li>
                        <li>
                            <strong>Fork the database on DoltHub:</strong> To
                            make more extensive changes, experiment, or manage
                            your own version, you can
                            <a
                                href="https://www.dolthub.com/repositories/holywritings/bahaiwritings?action=fork"
                                target="_blank"
                                >fork the repository on DoltHub</a
                            >.
                        </li>
                        <li>
                            <strong>Match prayers on TiddlyWiki:</strong> Visit
                            <a
                                href="https://tiddly.holywritings.net/workspace"
                                target="_blank"
                                >tiddly.holywritings.net/workspace</a
                            >
                            to match prayers. Save your results and email the
                            saved page to
                            <a href="mailto:ikojba@gmail.com"
                                >ikojba@gmail.com</a
                            >.
                        </li>
                        <li>
                            <strong>Assign missing Phelps codes:</strong>
                            This page uses codes based on the unique codes per
                            Bahá'í work from the
                            <a
                                href="https://afnanlibrary.org/a-partial-inventory/"
                                target="_blank"
                                >Partial Inventory</a
                            >
                            by Steven Phelps.
                            <ul>
                                <li>
                                    Your task is to identify the prayer in the
                                    Inventory. If found, use its assigned code.
                                </li>
                                <li>
                                    If the prayer is part of a larger work
                                    (e.g., a prayer from the Kitáb-i-Aqdas), a
                                    three-letter suffix (often mnemonic) should
                                    typically be appended to the main work's
                                    Phelps code (e.g., BH00001 for aqdas plus
                                    the suffix LOV becomes BH00001LOV).
                                </li>
                                <li>
                                    If a prayer is not in the inventory, please
                                    contact Steven so it can be included.
                                </li>
                                <li>
                                    You can use the "Add/Suggest Phelps Code"
                                    button on a prayer's page (if it lacks a
                                    code) to add this information to your item
                                    list for submission.
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <p>Your contributions are greatly appreciated!</p>
                </div>
            </main>
        </div>
        <div class="mdl-js-snackbar mdl-snackbar">
            <div class="mdl-snackbar__text"></div>
            <button class="mdl-snackbar__action" type="button"></button>
        </div>

        <dialog
            id="sql-display-dialog"
            style="
                width: 80%;
                max-width: 600px;
                border-radius: 8px;
                padding: 20px;
                border: 1px solid #ccc;
            "
        >
            <h4 style="margin-top: 0; color: #3f51b5">
                Generated SQL UPDATE Statements
            </h4>
            <textarea
                id="sql-display-textarea"
                readonly
                rows="10"
                style="
                    width: 100%;
                    font-family: monospace;
                    margin-bottom: 15px;
                    padding: 8px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    resize: vertical;
                    box-sizing: border-box;
                "
            ></textarea>
            <div style="text-align: right">
                <button
                    id="copy-sql-button"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored"
                >
                    <i class="material-icons" style="margin-right: 4px"
                        >content_copy</i
                    >
                    Copy
                </button>
                <button
                    id="close-sql-dialog-button"
                    class="mdl-button mdl-js-button"
                    style="margin-left: 8px"
                >
                    Close
                </button>
            </div>
        </dialog>

        <dialog
            id="dolthub-issue-dialog"
            style="
                width: 80%;
                max-width: 700px;
                border-radius: 8px;
                padding: 20px;
                border: 1px solid #ccc;
            "
        >
            <h4 style="margin-top: 0; color: #3f51b5">
                Review & Send Collected Items
            </h4>
            <p style="font-size: 0.9em; color: #555">
                The text below includes all collected items and suggested SQL. Review and edit as needed. You can then copy it, create a DoltHub issue, or share via email/messaging.
            </p>
            <textarea
                id="dolthub-issue-textarea"
                rows="15"
                style="
                    width: 100%;
                    font-family: monospace;
                    margin-bottom: 15px;
                    padding: 8px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    resize: vertical;
                    box-sizing: border-box;
                "
            ></textarea>
            <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: flex-end; margin-bottom:10px; padding-bottom:10px; border-bottom: 1px solid #eee;">
                 <button
                    id="dialog-mail-button"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored">
                    <i class="material-icons" style="margin-right: 4px">email</i>
                    Mail These Items
                </button>
                 <button
                    id="dialog-open-sql-doltub-button"
                    class="mdl-button mdl-js-button mdl-button--raised">
                    <i class="material-icons" style="margin-right: 4px">launch</i>
                    Run SQL on DoltHub
                </button>
            </div>
            <div
                style="
                    display: flex;
                    flex-wrap: wrap;
                    gap: 10px;
                    justify-content: flex-end;
                "
            >
                <button
                    id="copy-dolthub-issue-text-button"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored"
                >
                    <i class="material-icons" style="margin-right: 4px"
                        >content_copy</i
                    >
                    Copy Message
                </button>
                <button
                    id="open-new-dolthub-issue-page-button"
                    class="mdl-button mdl-js-button mdl-button--raised"
                    style="background-color: #24292e; color: white"
                >
                    <i class="material-icons" style="margin-right: 4px"
                        >bug_report</i
                    >
                    Open DoltHub Issue
                </button>
                <button
                    id="send-whatsapp-dolthub-issue-button"
                    class="mdl-button mdl-js-button mdl-button--raised"
                    style="
                        background-color: #25d366;
                        color: white;
                        padding: 0 12px;
                    "
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        style="
                            fill: white;
                            margin-right: 8px;
                            vertical-align: middle;
                        "
                    >
                        <path
                            d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.61 15.34 3.47 16.8L2.06 22L7.32 20.57C8.75 21.37 10.35 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 6.45 17.5 2 12.04 2M17.12 14.15C16.88 14.03 15.69 13.44 15.46 13.35C15.23 13.27 15.07 13.24 14.92 13.47C14.76 13.71 14.29 14.23 14.14 14.39C13.99 14.56 13.83 14.58 13.59 14.46C13.35 14.34 12.47 14.06 11.43 13.12C10.63 12.42 10.12 11.58 9.97 11.34C9.82 11.1 9.91 10.99 10.03 10.87C10.13 10.76 10.28 10.58 10.41 10.45C10.52 10.32 10.57 10.22 10.65 10.06C10.73 9.9 10.69 9.77 10.63 9.65C10.57 9.53 10.08 8.32 9.88 7.82C9.69 7.32 9.49 7.39 9.36 7.38C9.24 7.38 9.08 7.38 8.92 7.38C8.76 7.38 8.52 7.44 8.31 7.64C8.1 7.84 7.6 8.29 7.6 9.31C7.6 10.33 8.34 11.29 8.46 11.46C8.58 11.63 10.12 14.01 12.53 15.01C13.03 15.21 13.42 15.35 13.73 15.46C14.22 15.62 14.64 15.6 14.96 15.53C15.33 15.44 16.42 14.86 16.63 14.26C16.84 13.67 16.84 13.18 16.77 13.06C16.71 12.94 16.55 12.88 16.35 12.79"
                        /></svg
                    >WhatsApp
                </button>
                <button
                    id="send-telegram-dolthub-issue-button"
                    class="mdl-button mdl-js-button mdl-button--raised"
                    style="
                        background-color: #0088cc;
                        color: white;
                        padding: 0 12px;
                    "
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        style="
                            fill: white;
                            margin-right: 8px;
                            vertical-align: middle;
                        "
                    >
                        <path
                            d="M9.78 18.65l.28-4.23-7.68-2.62c-.77-.27-.77-1.41 0-1.68l16.19-5.81c.78-.28 1.48.37 1.18 1.15L12.69 18.2c-.26.73-1.23.73-1.49-.02zm1.95-4.29c.2-.25.12-.68-.19-.82L4.75 9.94l11.4-4.12-7.05 10.48.14-.09z"
                        /></svg
                    >Telegram
                </button>
                <button
                    id="close-dolthub-issue-dialog-button"
                    class="mdl-button mdl-js-button"
                    style="margin-left: 8px"
                >
                    Close
                </button>
            </div>
        </dialog>

        <script src="app.js" defer></script>

        <script>
            if (navigator.serviceWorker.controller) {
                console.log(
                    "[PWA Builder] active service worker found, no need to register",
                );
            } else {
                navigator.serviceWorker
                    .register("pwabuilder-sw.js", {
                        scope: "./",
                    })
                    .then(function (reg) {
                        console.log(
                            "Service worker has been registered for scope:" +
                                reg.scope,
                        );
                    });
            }
        </script>
    </body>
</html>
