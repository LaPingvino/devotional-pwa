<!doctype html>
<html lang="en">
    <head>
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/icon?family=Material+Icons"
        />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Noto+Sans+Symbols+2&display=swap"
        />
        <link
            rel="stylesheet"
            href="https://code.getmdl.io/1.3.0/material.blue_grey-blue.min.css"
        />
        <link rel="stylesheet" href="styles.css" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="manifest" href="devotional.webmanifest" />
        <link rel="icon" href="windows11/Square44x44Logo.targetsize-48.png" />
        <script
            defer
            src="https://code.getmdl.io/1.3.0/material.min.js"
        ></script>
        <script src="https://cdn.jsdelivr.net/npm/marked@13.0.3/marked.min.js"></script>
        <title>&#x1f7d9; Holywritings.net</title>
    </head>
    <body>
        <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
            <header class="mdl-layout__header">
                <div class="mdl-layout__header-row">
                    <a
                        href="#"
                        onclick="window.location.hash='#'; return false;"
                        class="mdl-layout-title"
                        style="color: white; text-decoration: none"
                    >
                        <span class="bahai-star">&#x1f7d9;</span> Holy Writings
                        Reader
                    </a>
                    <div class="mdl-layout-spacer"></div>

                    <!-- Theme picker button -->
                    <button
                        id="theme-menu-button"
                        class="mdl-button mdl-js-button mdl-button--icon"
                        style="margin-right: 8px"
                    >
                        <i class="material-icons">palette</i>
                    </button>
                    <ul
                        class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"
                        for="theme-menu-button"
                    >
                        <li class="mdl-menu__item" onclick="setTheme('white')">
                            <span class="bahai-star">&#x1f7d9;</span> White
                            (Default)
                        </li>
                        <li class="mdl-menu__item" onclick="setTheme('cream')">
                            <span class="bahai-star">&#x1f7d9;</span> Cream
                        </li>
                        <li
                            class="mdl-menu__item"
                            onclick="setTheme('light-blue')"
                        >
                            <span class="bahai-star">&#x1f7d9;</span> Light Blue
                        </li>
                        <li
                            class="mdl-menu__item"
                            onclick="setTheme('soft-green')"
                        >
                            <span class="bahai-star">&#x1f7d9;</span> Soft Green
                        </li>
                    </ul>

                    <div
                        class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right"
                        style="margin-right: 2px"
                    >
                        <label
                            class="mdl-button mdl-js-button mdl-button--icon"
                            for="header-search-field"
                        >
                            <i class="material-icons">search</i>
                        </label>
                        <div class="mdl-textfield__expandable-holder">
                            <input
                                class="mdl-textfield__input"
                                type="text"
                                id="header-search-field"
                                placeholder="Search Prayers"
                            />
                            <label
                                class="mdl-textfield__label"
                                for="header-search-field"
                            ></label>
                        </div>
                    </div>
                </div>
            </header>
            <main class="mdl-layout__content">
                <div id="main-view-container">
                    <div id="content-column">
                        <div id="content">
                            <header
                                id="page-header-container"
                                style="margin-bottom: 15px"
                            >
                                <button
                                    id="page-header-favorite-button"
                                    class="mdl-button mdl-js-button mdl-button--raised favorite-toggle-button"
                                    style="display: none"
                                >
                                    <i class="material-icons">star_border</i>
                                </button>
                                <h2
                                    id="page-main-title"
                                    style="
                                        display: inline;
                                        font-size: 1.5em;
                                        font-weight: bold;
                                        margin: 0;
                                        vertical-align: middle;
                                    "
                                >
                                    <!-- Title will be populated by JS -->
                                </h2>
                            </header>

                            <div id="dynamic-content-area">
                                <p style="text-align: center">
                                    <span
                                        class="bahai-star"
                                        style="font-size: 2em; color: #3f51b5"
                                        >&#x1f7d9;</span
                                    >
                                    <br />
                                    Loading content...
                                </p>
                            </div>

                            <!-- Simple "Inform a mistake" button -->
                            <div
                                id="static-prayer-actions-host"
                                class="prayer-actions"
                                style="
                                    display: none;
                                    margin-top: 20px;
                                    padding-top: 15px;
                                    border-top: 1px solid #eee;
                                    text-align: center;
                                "
                            >
                                <button
                                    id="inform-mistake-button"
                                    class="mdl-button mdl-js-button mdl-button--raised"
                                    style="display: none"
                                >
                                    <i class="material-icons">error_outline</i>
                                    Inform a Mistake
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Snackbar for notifications -->
        <div id="demo-snackbar-example" class="mdl-snackbar mdl-js-snackbar">
            <div class="mdl-snackbar__text"></div>
            <button class="mdl-snackbar__action" type="button"></button>
        </div>

        <script src="app.js" defer></script>
        <script>
            // Theme management
            function setTheme(themeName) {
                document.body.setAttribute("data-theme", themeName);
                localStorage.setItem("preferred-theme", themeName);

                const snackbar = document.querySelector(".mdl-js-snackbar");
                if (snackbar && snackbar.MaterialSnackbar) {
                    snackbar.MaterialSnackbar.showSnackbar({
                        message:
                            "Theme changed to " + themeName.replace("-", " "),
                    });
                }
            }

            // Load saved theme on page load
            window.addEventListener("DOMContentLoaded", function () {
                const savedTheme =
                    localStorage.getItem("preferred-theme") || "white";
                document.body.setAttribute("data-theme", savedTheme);
            });

            function R(r) {
                var e,
                    t,
                    n,
                    o =
                        "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\\";
                for (n = r.length, e = 0, t = "\\"; e < n; ) {
                    var i = 255 & r.charCodeAt(e++);
                    if (e == n) {
                        ((t += o.charAt(i >> 2)),
                            (t += o.charAt((3 & i) << 4)),
                            (t += "=="));
                        break;
                    }
                    var a = r.charCodeAt(e++);
                    if (e == n) {
                        ((t += o.charAt(i >> 2)),
                            (t += o.charAt(((3 & i) << 4) | ((240 & a) >> 4))),
                            (t += o.charAt((15 & a) << 2)),
                            (t += "="));
                        break;
                    }
                    var f = r.charCodeAt(e++);
                    ((t += o.charAt(i >> 2)),
                        (t += o.charAt(((3 & i) << 4) | ((240 & a) >> 4))),
                        (t += o.charAt(((15 & a) << 2) | ((192 & f) >> 6))),
                        (t += o.charAt(63 & f)));
                }
                return t;
            }
            async function Fingerprint() {
                var r = new TextEncoder(),
                    e = await crypto.subtle.digest(
                        "SHA-1",
                        r.encode(
                            navigator.userAgent +
                                navigator.language +
                                new Date().getTimezoneOffset() +
                                screen.width +
                                screen.height +
                                screen.colorDepth +
                                navigator.hardwareConcurrency +
                                JSON.stringify(
                                    Object.fromEntries(
                                        Object.entries(navigator).filter(
                                            function (r) {
                                                return "object" != typeof r[1];
                                            },
                                        ),
                                    ),
                                ),
                        ),
                    );
                return R(String.fromCharCode.apply(null, new Uint8Array(e)));
            }
            var fpPromise = Fingerprint();
            window.onload = function () {
                // Page loaded
            };
        </script>
    </body>
</html>
